{% extends "layout.html" %}

{% block title %}
    Shop
{% endblock %}

{% block main %}
    <h1>Shop</h1>
    {% if rest != none %}
    <p class="bg-dark text-light p-2">You need to earn {{rest}} more Coins to buy this item <br>
      <a href="/about" class="text-light">Why is this so expensive?</a>
    </p>
    {% endif %}

    <div class="items pt-2">
    {% for item in inventory %}
    <div class="item">
        <img src="{{item['img']}}" class="border-radius">
        <p>{{item['name']}}<br> Price {{item['price']}}$ <br> {{item['price'] | coins}} Coins</p>
        <div class="detail">

           <header>
             <h2>{{item['name']}}</h2>
             <span class="iconify" data-inline="false" data-icon="ci:close-big" style="font-size: 44px;"></span>
           </header>

          <div>
            {% if item['content'] != 0 %}
              <video  autoplay  loop>
                 <source src="{{item['content']}}" type="video/mp4" poster="{{item['img']}}">
              </video>
            {% else %}
            <img src="{{item['img']}}">
            {% endif %}
              <form method="post" action="/shop">
                <br>
                <button class="btn btn-dark" value="{{item['price']}}" name="price" type="submit">
                  Add to cart</button>
              </form>
          </div>

          <p>
            Price {{item['price'] | coins}} Coins ({{item['price']}}$)<br>
            Format: {{item['type']}} <br>
            Duration: {{item['duration']}} <br>
            Title: {{item['name']}} <br>
            Edition: {{item['edition']}}/6 <br>
            After purchase you will get a link to download the file
          </p>
        </div>
      </div>
        {% endfor %}

    </div>


    <script type="text/javascript">

    const items = document.querySelectorAll(".item");


    function show_details(e){
      detail = this.querySelector(".detail");
      detail.classList.toggle("open");
      document.querySelector("body").classList.toggle("open");
      localStorage.setItem('detail', this.dataset.id);
    }

    items.forEach((item) => {
      item.addEventListener('click', show_details);
    });


  </script>

{% endblock %}
